<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Inverse Analysis in FEniCS | MechEngrLorenzoFiore</title>

    



<meta name="author" content="Lorenzo Fiore" />
<meta name="description" content="Inverse Analysis in FEniCS Motivation and context  The FEniCS open-source computing platform is a wonderful collection of software, it contains all the tools needed to rigorously define a mathematical problem in computer code in a very high level form, it feels almost as writing the equations of physics and let the computer solve them for you! Well&amp;hellip; to be honest FEniCS only provides the backbone of a full fledged Finite Element Software, it&amp;rsquo;s like having a kit to be assembled according to ones taste: everything that goes from the definition of the equations of physics, to the handling of incremental solving procedure and output is a user-responsibility." />



<meta name="generator" content="Hugo 0.82.0" />

<link rel="canonical" href="https://MechEngrLorenzoFiore.github.io/posts/inverse_analysis_in_fenics/" />


<meta property="og:title" content="Inverse Analysis in FEniCS" />
<meta property="og:description" content="Inverse Analysis in FEniCS Motivation and context  The FEniCS open-source computing platform is a wonderful collection of software, it contains all the tools needed to rigorously define a mathematical problem in computer code in a very high level form, it feels almost as writing the equations of physics and let the computer solve them for you! Well&hellip; to be honest FEniCS only provides the backbone of a full fledged Finite Element Software, it&rsquo;s like having a kit to be assembled according to ones taste: everything that goes from the definition of the equations of physics, to the handling of incremental solving procedure and output is a user-responsibility." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://MechEngrLorenzoFiore.github.io/posts/inverse_analysis_in_fenics/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-05-08T15:38:00&#43;00:00" />
<meta property="article:modified_time" content="2024-05-08T15:38:00&#43;00:00" />




<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Inverse Analysis in FEniCS"/>
<meta name="twitter:description" content="Inverse Analysis in FEniCS Motivation and context  The FEniCS open-source computing platform is a wonderful collection of software, it contains all the tools needed to rigorously define a mathematical problem in computer code in a very high level form, it feels almost as writing the equations of physics and let the computer solve them for you! Well&hellip; to be honest FEniCS only provides the backbone of a full fledged Finite Element Software, it&rsquo;s like having a kit to be assembled according to ones taste: everything that goes from the definition of the equations of physics, to the handling of incremental solving procedure and output is a user-responsibility."/>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">
<link rel="stylesheet" href="/css/icomoon.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/overlayscrollbars@1.13.1/css/OverlayScrollbars.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css">
<link rel="stylesheet" href="/css/site.css" />

<style>
  a:not(.ui.button):hover {
    text-decoration: underline;
  }

  
  a:not(.ui.button) {
    color: seagreen !important;
  }
  

  

  
  body.default {
    
    background-color: #f7f7f7;
    

    
  }
  

  
</style>


    







    
  </head>

  <body class="default">
    
<nav class="ui secondary menu dream-menu">

  <div class="item">
    <i class="large link bullseye icon dream-flip-toggle" title="Flip it!"></i>
  </div>
  <div class="item">
    <i class="large link home icon" title="Home" onclick="window.location.href = 'https:\/\/MechEngrLorenzoFiore.github.io\/'"></i>
  </div>
  
  
  <div class="item">
    <i class="large link search icon" onclick="toggleSearch()"></i>
  </div>
  
</nav>

    <div class="flip-container">
      <div class="flipper">
        <section class="front">
          <div class="dream-max-width">
            
<div class="ui relaxed centered grid dream-grid dream-grid-single">
  
  
  
  

  
  <aside class="sixteen wide mobile sixteen wide tablet three wide computer column dream-single-aside">
  
    
    <div class="ui segment toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#motivation-and-context">Motivation and context</a></li>
    <li><a href="#challenges-i-faced">Challenges I faced</a></li>
    <li><a href="#useful-lessons-i-learned">Useful lessons I learned</a></li>
  </ul>
</nav>
    </div>
    

    
  
  </aside>
  
  <div class="sixteen wide mobile sixteen wide tablet ten wide computer column markdown-body dream-single" id="dream-save-post-as-img">
    <section class="ui top attached segment">
      <header>
        <h1 class="ui large header">Inverse Analysis in FEniCS<div class="sub header">
            <div class="left">
              @
              
                
                  Lorenzo Fiore
                
              

              | 
                  
                    Wednesday, May 8, 2024
                  
                

              | 12 minutes read

              
            </div>

            
            <div class="dream-share">
  <a href="#" class="save-as-image" title="Save as image" onclick="savePostAsImg()">
    <i class="save icon"></i>
  </a>
  </a>
  <a href="https://www.linkedin.com/in/lorenzo-fiore-372b83194/">
    <i class="linkedin icon"></i>
  </a>
</div>




            
          </div>
        </h1>
      </header>

      <article class="main">
        

        <h1 id="inverse-analysis-in-fenics">Inverse Analysis in FEniCS</h1>
<h2 id="motivation-and-context">Motivation and context</h2>
<ul>
<li>The FEniCS open-source computing platform is a wonderful collection of software, it contains all the tools needed to rigorously define a mathematical problem in computer code in a very high level form, it feels almost as writing the equations of physics and let the computer solve them for you!</li>
<li>Well&hellip; to be honest FEniCS only provides the backbone of a full fledged Finite Element Software, it&rsquo;s like having a kit to be assembled according to ones taste: everything that goes from the definition of the equations of physics, to the handling of incremental solving procedure and output is a user-responsibility.</li>
<li>This can seem inconvenient to the user accustomed to full-fledged commercial Finite Element Software, but to me it&rsquo;s marvelous! It&rsquo;s the perfect platform to automate analysis and procedures, and I put it on test running an inverse analysis procedure: I defined a script with all the settings for the analysis of fracture in a Wedge Splitting Test and I wanted to find the material parameters more apt to reproduce the experimental curve that I had available.</li>
</ul>
<h2 id="challenges-i-faced">Challenges I faced</h2>
<ul>
<li>For the purpose of the Inverse Analysis we can treat the simulation script as a black-box: material parameters go in and a force-displacement curve goes out (together with some info on time-stepping, elastic energy, fracture propagation, &hellip; whatever I want or I&rsquo;m able to code!).</li>
<li>The task is thus &ldquo;just&rdquo; that to:
<ol>
<li>compare the simulation output with the reference experimental one (for a simulation engineer, reality is the only truth and guidance);</li>
<li>change the simulation parameters according to some smart logic to hope to be closer to reality;</li>
<li>run another simulation with the updated parameters;</li>
<li>loop the previous steps until satisfied.</li>
</ol>
</li>
<li>Task 1. is what people refer to as &ldquo;defining an objective function&rdquo;: if the goal is that of being closer to the experimental results, we want to minimize some distance. What is this distance, how do we compute it? The good old sum of the square of distances comes in handy here.</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#75715e"># read experimental data</span>
experimental_data <span style="color:#f92672">=</span> {}
experimental_data[<span style="color:#e6db74">&#34;open mm&#34;</span>] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>genfromtxt(<span style="color:#e6db74">&#34;experimental_data.md&#34;</span>, usecols <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)
experimental_data[<span style="color:#e6db74">&#34;HRF kN&#34;</span>] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>genfromtxt(<span style="color:#e6db74">&#34;experimental_data.md&#34;</span>, usecols <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>)

<span style="color:#75715e"># read result file storing force and relative displacement</span>
computed_data <span style="color:#f92672">=</span> {}
computed_data[<span style="color:#e6db74">&#34;open mm&#34;</span>] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>genfromtxt(<span style="color:#e6db74">&#34;sim_ID_results.md&#34;</span>, usecols <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)
computed_data[<span style="color:#e6db74">&#34;HRF kN&#34;</span>] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>genfromtxt(<span style="color:#e6db74">&#34;sim_ID_results.md&#34;</span>, usecols <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>)

<span style="color:#75715e"># interpolate experimental data at simulation time-steps</span>
interpolated_experimental_data <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>interp(computed_data[<span style="color:#e6db74">&#34;open mm&#34;</span>], experimental_data[<span style="color:#e6db74">&#34;open mm&#34;</span>], experimental_data[<span style="color:#e6db74">&#34;HRF kN&#34;</span>])

<span style="color:#75715e"># compute the objective function value</span>
obj_func_val <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(np<span style="color:#f92672">.</span>sum(np<span style="color:#f92672">.</span>square(computed_data[<span style="color:#e6db74">&#34;HRF kN&#34;</span>] <span style="color:#f92672">-</span> interpolated_experimental_data)))
</code></pre></div><ul>
<li>Task 2. is a bit more involved, we got to understand how to change the parameters. As already hinted before, inverse analysis can be framed in the context of a minimization problem, so we can leverage the algorithms developed for these problems. The steepest descent algorithm with variable multiplier is my choice.</li>
<li>The idea is simple: identify the direction of maximum decrease of your objective function and take a step in that direction, but careful! Choose wisely the length of the step according to your previous knowledge.</li>
<li>For the computation of the gradient in this case there is no much choice, it has to be done with a finite differences numerical approach.</li>
<li>The step length computation is a bit more interesting, the idea is to test multiple step lengths, identify the one that leads to the minimum value of the objective function and keep this information for the next iteration. This means more evaluations of the objective function at each iteration but, hopefully, fewer iterations with respect to a fixed step length approach.</li>
<li>A comment regarding objective function evaluation: each evaluation means a finite element computation so the fewer the better of course! Additionally if we ask for the value of the function in the same point twice we shouldn&rsquo;t run the related simulation twice, so it&rsquo;s better to store the information somewhere.</li>
<li>Storing information is a good idea overall and it&rsquo;s a good practice that I try to implement in all my scripts: whenever I have to run a long lasting calculation I always make sure to write the main info of each step in a simple text file. It&rsquo;s a good way to understand if everything is running as intended and a good starting point for post-processing of results.</li>
</ul>
<pre><code>[min]	[sim N]	 [alpha]  	  [Emod]  	[obj_val] 	 [grad 0] 	 [update] 	
 26  	  2  	   0.1    	 1.31e+09 	  1003.2  	    -     	    -     	
 26  	  2  	   0.1    	 1.3e+09  	  1013.9  	-1.0664e+09	    0     	
 55  	  3  	   0.1    	1.4066e+09	  900.54  	    -     	    -     	
 55  	  4  	   0.2    	1.5133e+09	  788.59  	    -     	    1     	
 55  	  4  	   0.1    	1.4066e+09	  900.54  	    -     	    -     	
 69  	  5  	   0.2    	1.5233e+09	  778.98  	    -     	    -     	
 69  	  5  	   0.2    	1.5133e+09	  788.59  	-9.6115e+08	    1     	
 102 	  6  	   0.2    	1.7055e+09	  619.22  	    -     	    -     	
 102 	  7  	   0.4    	1.8977e+09	  498.15  	    -     	    2     	
 102 	  7  	   0.2    	1.7055e+09	  619.22  	    -     	    -     	
 119 	  8  	   0.4    	1.9077e+09	  495.15  	    -     	    -     	
 119 	  8  	   0.4    	1.8977e+09	  498.15  	-3.0014e+08	    2     	
 160 	  9  	   0.4    	2.0178e+09	  462.09  	    -     	    -     	
 160 	 10  	   0.8    	2.1378e+09	  423.51  	    -     	    3     	
</code></pre><h2 id="useful-lessons-i-learned">Useful lessons I learned</h2>
<ul>
<li>This project was the perfect excuse to un-rust my usage of classes in python, most of my coding is for automation of repetitive tasks and I don&rsquo;t get to use the object-oriented paradigm a lot for that. In this case thought I wanted to create an internal counter for the objective function incrementing every time the function itself is called and I ended up doing so with an Instance method parameter.</li>
<li>The script I ended up with is reported down here and it can be used with whatever Finite Element Software provided that such software can take command line input and output results in text format.</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">- The script is meant to calculate material properties for a material
</span><span style="color:#e6db74">  by performing inverse analysis on experimental results using the 
</span><span style="color:#e6db74">  constitutive model with phase field fracture here implemented in
</span><span style="color:#e6db74">  FEniCS
</span><span style="color:#e6db74">- This script contains only the inverse analysis procedure with
</span><span style="color:#e6db74">  a simple steepest descent algo while the FEM simulation and the 
</span><span style="color:#e6db74">  related settings are implemented in other scripts (see WST.py)
</span><span style="color:#e6db74">- The objective function is embedded in a class that creates it 
</span><span style="color:#e6db74">  taking as input the FEM model file, the material data and the 
</span><span style="color:#e6db74">  labels of the parameters to identify
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>

<span style="color:#75715e">#%% ---------------------------------------------------------------70</span>
<span style="color:#75715e"># Import necessary packages</span>
<span style="color:#75715e"># -----------------------------------------------------------------70</span>
<span style="color:#f92672">import</span> os
<span style="color:#f92672">import</span> sys
<span style="color:#f92672">import</span> time
<span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> datetime
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np


<span style="color:#75715e">#%% ---------------------------------------------------------------70</span>
<span style="color:#75715e"># Control parameters</span>
<span style="color:#75715e"># -----------------------------------------------------------------70</span>

material_data <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lab_test_240416T1520&#34;</span>

experimental_data_file <span style="color:#f92672">=</span> material_data <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;_Fd_data.csv&#34;</span>

FEM_file <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;WST.py&#34;</span>

parameters_labels <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;Emod&#34;</span>]

<span style="color:#75715e"># initial guess consistent with the choice for the sim parameters</span>
initial_guess <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1.3e9</span>]

<span style="color:#75715e"># setup limits for the parameters space</span>
limits <span style="color:#f92672">=</span> [
    [<span style="color:#ae81ff">0.8e9</span>, <span style="color:#ae81ff">50e9</span>]
]

<span style="color:#75715e"># perturbation for the calculation of the gradient of objective function</span>
perturbation <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0.01e9</span>]

<span style="color:#75715e"># scale of the parameters </span>
scale_factor <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1e15</span>]

<span style="color:#75715e"># columns identifiers for the simulation output file</span>
interested_cols_identifiers <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;open mm&#34;</span>, <span style="color:#e6db74">&#34;HRF kN&#34;</span>]

<span style="color:#75715e"># initialize step length</span>
alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.1</span>

<span style="color:#75715e"># allow the step length multiplier to change</span>
explore_alpha_variation_flag <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>

<span style="color:#75715e"># set the increasing-decreasing alpha factor</span>
exploration_factors_list <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0.5</span>]

<span style="color:#75715e"># tolerance for the minimization of the objective function</span>
tolerance <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.1</span>

<span style="color:#75715e"># iteration limit for the minimization algo</span>
max_sims_counter <span style="color:#f92672">=</span> <span style="color:#ae81ff">50</span> 

<span style="color:#75715e"># allow objective function to increase for a certain number of times</span>
max_objective_function_increase_counter <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>

<span style="color:#75715e"># maximum number of inverse analysis iterations</span>
max_iterations <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>

<span style="color:#75715e"># specify if you want to timestamp the output or not</span>
timestamp_flag <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>


<span style="color:#75715e">#%% ---------------------------------------------------------------70</span>
<span style="color:#75715e"># Filesystem settings</span>
<span style="color:#75715e"># -----------------------------------------------------------------70</span>

folder_descriptor <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Inverse_Analysis_&#34;</span> <span style="color:#f92672">+</span> material_data

now <span style="color:#f92672">=</span> datetime<span style="color:#f92672">.</span>now()
dt_string <span style="color:#f92672">=</span> now<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#34;%Y%m</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">T%H%M&#34;</span>)[<span style="color:#ae81ff">2</span>:]

<span style="color:#66d9ef">if</span> timestamp_flag:
    outfolder <span style="color:#f92672">=</span> dt_string <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;_&#34;</span> <span style="color:#f92672">+</span> folder_descriptor
<span style="color:#66d9ef">else</span>:
    outfolder <span style="color:#f92672">=</span> folder_descriptor

<span style="color:#75715e"># create output folder</span>
os<span style="color:#f92672">.</span>system(<span style="color:#e6db74">&#34;mkdir &#34;</span> <span style="color:#f92672">+</span> outfolder)

<span style="color:#75715e"># copy this file to the inverse analysis folder for forensics</span>
os<span style="color:#f92672">.</span>system(<span style="color:#e6db74">&#34;cp &#34;</span> <span style="color:#f92672">+</span> __file__ <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; ./&#34;</span> <span style="color:#f92672">+</span> outfolder <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> 
        __file__<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;.py&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>) <span style="color:#f92672">+</span>
        <span style="color:#e6db74">&#34;_&#34;</span> <span style="color:#f92672">+</span> dt_string <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.py&#34;</span> )

<span style="color:#75715e"># copy the sim file to the inverse analysis folder for forensics</span>
os<span style="color:#f92672">.</span>system(<span style="color:#e6db74">&#34;cp &#34;</span> <span style="color:#f92672">+</span> FEM_file <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; ./&#34;</span> <span style="color:#f92672">+</span> outfolder <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> 
        FEM_file<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;.py&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>) <span style="color:#f92672">+</span>
        <span style="color:#e6db74">&#34;_&#34;</span> <span style="color:#f92672">+</span> dt_string <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.py&#34;</span> )

<span style="color:#75715e"># copy the material data file to the inverse analysis folder for forensics</span>
os<span style="color:#f92672">.</span>system(<span style="color:#e6db74">&#34;cp &#34;</span> <span style="color:#f92672">+</span> material_data <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.py&#34;</span> <span style="color:#f92672">+</span> 
            <span style="color:#e6db74">&#34; ./&#34;</span> <span style="color:#f92672">+</span> outfolder <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> material_data <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;_&#34;</span> <span style="color:#f92672">+</span> dt_string <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.py&#34;</span>)

<span style="color:#75715e"># inverse analysis output file</span>
outfile <span style="color:#f92672">=</span> outfolder <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;README.md&#34;</span>

<span style="color:#75715e"># prompt for forensic</span>
readme <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#34;Describe why to run this inverse analysis procedure: </span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
<span style="color:#66d9ef">with</span> open(outfile, <span style="color:#e6db74">&#34;w&#34;</span>) <span style="color:#66d9ef">as</span> file:
    file<span style="color:#f92672">.</span>writelines(readme)


<span style="color:#75715e">#%% ---------------------------------------------------------------70</span>
<span style="color:#75715e"># Objective function definition</span>
<span style="color:#75715e"># -----------------------------------------------------------------70</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">fileprint</span>(string):
    <span style="color:#66d9ef">print</span>(string)
    <span style="color:#66d9ef">with</span> open(outfile, <span style="color:#e6db74">&#34;a&#34;</span>) <span style="color:#66d9ef">as</span> file:
        file<span style="color:#f92672">.</span>writelines( <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">+</span> string)


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">retrieve_info</span>(file, interested_cols_identifiers):
    <span style="color:#75715e"># take out header string</span>
    <span style="color:#66d9ef">with</span> open(file, <span style="color:#e6db74">&#34;r&#34;</span>) <span style="color:#66d9ef">as</span> file_opener:
        head <span style="color:#f92672">=</span> [next(file_opener) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>)]
    header_string <span style="color:#f92672">=</span> head[<span style="color:#ae81ff">1</span>]
    
    <span style="color:#75715e"># identify columns corresponding to interested quantities</span>
    interested_cols <span style="color:#f92672">=</span> {}
    character_counter <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    word_counter <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
    close <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">for</span> character <span style="color:#f92672">in</span> header_string:
        character_counter <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">if</span> character <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;[&#34;</span>:
            init <span style="color:#f92672">=</span> character_counter
        <span style="color:#66d9ef">elif</span> character <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;]&#34;</span>:
            close <span style="color:#f92672">=</span> character_counter
            identifier <span style="color:#f92672">=</span> header_string[init:close<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
            word_counter <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
            <span style="color:#66d9ef">if</span> identifier <span style="color:#f92672">in</span> interested_cols_identifiers:
                interested_cols[identifier] <span style="color:#f92672">=</span> word_counter
    
    computed_data <span style="color:#f92672">=</span> {}
    <span style="color:#66d9ef">for</span> identifier <span style="color:#f92672">in</span> interested_cols_identifiers:
        computed_data[identifier] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>genfromtxt(
                            file,
                            skip_header <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>, 
                            skip_footer <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>, 
                            usecols <span style="color:#f92672">=</span> interested_cols[identifier]
                        )
    <span style="color:#66d9ef">return</span> computed_data


<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">objective_function_creator</span>():
    <span style="color:#66d9ef">def</span> __init__(self, parameters_labels, FEM_file, experimental_data, material_data, interested_cols_identifiers, outfolder):
        self<span style="color:#f92672">.</span>parameters_labels <span style="color:#f92672">=</span> parameters_labels
        self<span style="color:#f92672">.</span>FEM_file <span style="color:#f92672">=</span> FEM_file
        self<span style="color:#f92672">.</span>experimental_data <span style="color:#f92672">=</span> experimental_data
        self<span style="color:#f92672">.</span>material_data <span style="color:#f92672">=</span> material_data
        self<span style="color:#f92672">.</span>sims_counter <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        self<span style="color:#f92672">.</span>interested_cols_identifiers <span style="color:#f92672">=</span> interested_cols_identifiers
        self<span style="color:#f92672">.</span>outfolder <span style="color:#f92672">=</span> outfolder
        self<span style="color:#f92672">.</span>nparams <span style="color:#f92672">=</span> len(parameters_labels)
    
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">evaluate</span>(self, params):
        <span style="color:#e6db74">&#34;&#34;&#34;inverse analysis objective function
</span><span style="color:#e6db74">        Inputs: 
</span><span style="color:#e6db74">            - the parameters to optimize for
</span><span style="color:#e6db74">            - FEM simulation file 
</span><span style="color:#e6db74">            - experimental data file
</span><span style="color:#e6db74">        Output: a single scalar, sqrt of sum of the differences between 
</span><span style="color:#e6db74">                experimental and calculated at each sim time step
</span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
        
        <span style="color:#75715e"># pack the parameters in an identification string </span>
        sim_ID <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>    
        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(self<span style="color:#f92672">.</span>nparams):
            sim_ID <span style="color:#f92672">+=</span> self<span style="color:#f92672">.</span>parameters_labels[i] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;_&#34;</span> <span style="color:#f92672">+</span> str(params[i]) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;_&#34;</span>
        
        <span style="color:#75715e"># check if simulation was already run</span>
        sim_already_run_flag <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">for</span> file <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(self<span style="color:#f92672">.</span>outfolder):
            <span style="color:#66d9ef">if</span> file <span style="color:#f92672">==</span> sim_ID <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.md&#34;</span>:
                sim_already_run_flag <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
        
        <span style="color:#75715e"># run sim if necessary</span>
        <span style="color:#66d9ef">if</span> sim_already_run_flag <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            <span style="color:#75715e"># printout a message to monitor inverse analysis procedure</span>
            <span style="color:#66d9ef">print</span>(f<span style="color:#e6db74">&#34;running sim: &#34;</span> <span style="color:#f92672">+</span> sim_ID)
            
            <span style="color:#75715e"># launch the FEM with the input parameters</span>
            os<span style="color:#f92672">.</span>system(<span style="color:#e6db74">&#34;python &#34;</span> <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>FEM_file <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; &#34;</span> <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>material_data <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; &#34;</span> <span style="color:#f92672">+</span> sim_ID <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; &#34;</span> <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>outfolder)
            
            <span style="color:#75715e"># update simulations counter</span>
            self<span style="color:#f92672">.</span>sims_counter <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
            
            <span style="color:#75715e"># check completion</span>
            completed_flag <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
            <span style="color:#66d9ef">while</span> completed_flag <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
                <span style="color:#66d9ef">for</span> file <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(<span style="color:#e6db74">&#34;./&#34;</span> <span style="color:#f92672">+</span> outfolder <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span>):
                    <span style="color:#66d9ef">if</span> file <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;simulation_completed.md&#34;</span>:
                        completed_flag <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
            
            <span style="color:#75715e"># delete the flag file</span>
            os<span style="color:#f92672">.</span>system(<span style="color:#e6db74">&#34;rm &#34;</span> <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>outfolder <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;simulation_completed.md&#34;</span>)

        <span style="color:#75715e"># read result file</span>
        computed_data <span style="color:#f92672">=</span> retrieve_info(self<span style="color:#f92672">.</span>outfolder <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> sim_ID <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.md&#34;</span>, self<span style="color:#f92672">.</span>interested_cols_identifiers)
        
        <span style="color:#75715e"># interpolate experimental data at simulation time-steps</span>
        interpolated_experimental_data <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>interp(computed_data[<span style="color:#e6db74">&#34;open mm&#34;</span>], self<span style="color:#f92672">.</span>experimental_data[:,<span style="color:#ae81ff">0</span>], self<span style="color:#f92672">.</span>experimental_data[:,<span style="color:#ae81ff">1</span>])<span style="color:#f92672">*</span><span style="color:#ae81ff">1e-3</span>
        
        <span style="color:#75715e"># be careful with the consistency of the units of measure, the factor 1e3 serves this purpose</span>
        obj_func_val <span style="color:#f92672">=</span> <span style="color:#ae81ff">1e3</span><span style="color:#f92672">*</span>np<span style="color:#f92672">.</span>sqrt(np<span style="color:#f92672">.</span>sum(np<span style="color:#f92672">.</span>square(computed_data[<span style="color:#e6db74">&#34;HRF kN&#34;</span>] <span style="color:#f92672">-</span> interpolated_experimental_data)))

        <span style="color:#66d9ef">return</span> obj_func_val


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">update_params</span>(paramaters_array, increment, limits):
    <span style="color:#75715e"># update parameters within limits</span>
    
    <span style="color:#75715e"># careful with the += operator, it updates the input too !!!</span>
    paramaters_array <span style="color:#f92672">=</span> paramaters_array <span style="color:#f92672">+</span> increment
    
    <span style="color:#66d9ef">for</span> ii <span style="color:#f92672">in</span> range(len(params)):
        paramaters_array[ii] <span style="color:#f92672">=</span> max(limits[ii][<span style="color:#ae81ff">0</span>], paramaters_array[ii])
        paramaters_array[ii] <span style="color:#f92672">=</span> min(limits[ii][<span style="color:#ae81ff">1</span>], paramaters_array[ii])
        
    <span style="color:#66d9ef">return</span> paramaters_array


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">forensic_printout</span>(sims_counter, alpha, params, obj_func_val, gradient, update):
    <span style="color:#75715e"># printout CPU time</span>
    info_string <span style="color:#f92672">=</span> f<span style="color:#e6db74">&#34;{int((time.time() - tic)/60):^5}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>

    <span style="color:#75715e"># printout number of simulations run</span>
    info_string <span style="color:#f92672">+=</span> f<span style="color:#e6db74">&#34;{sims_counter:^5}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>

    <span style="color:#75715e"># printout alpha value</span>
    info_string <span style="color:#f92672">+=</span> f<span style="color:#e6db74">&#34;{alpha:^10.5g}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>

    <span style="color:#75715e"># printout parameters</span>
    <span style="color:#66d9ef">for</span> param <span style="color:#f92672">in</span> params:
        info_string <span style="color:#f92672">+=</span> f<span style="color:#e6db74">&#34;{param:^10.5g}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>

    <span style="color:#75715e"># printout objective function value</span>
    info_string <span style="color:#f92672">+=</span> f<span style="color:#e6db74">&#34;{obj_func_val:^10.5g}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>

    <span style="color:#75715e"># printout gradient components</span>
    <span style="color:#66d9ef">for</span> ii <span style="color:#f92672">in</span> range(nparams):
        <span style="color:#66d9ef">try</span>:
            info_string <span style="color:#f92672">+=</span> f<span style="color:#e6db74">&#34;{gradient[ii]:^10.5g}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>
        <span style="color:#66d9ef">except</span>:
            info_string <span style="color:#f92672">+=</span> f<span style="color:#e6db74">&#34;{gradient[ii]:^10}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>

    <span style="color:#75715e"># printout placeholder for the update flag</span>
    info_string <span style="color:#f92672">+=</span> f<span style="color:#e6db74">&#34;{update:^10}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>
    
    fileprint( info_string )

<span style="color:#75715e">#%% ---------------------------------------------------------------70</span>
<span style="color:#75715e"># Messages to the user</span>
<span style="color:#75715e"># -----------------------------------------------------------------70</span>

<span style="color:#75715e"># number of parameters</span>
nparams <span style="color:#f92672">=</span> len(parameters_labels)

<span style="color:#75715e"># README file heading</span>
info_string <span style="color:#f92672">=</span> f<span style="color:#e6db74">&#34;{&#39;[min]&#39;:^5}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">+</span>\
              f<span style="color:#e6db74">&#34;{&#39;[sim N]&#39;:^5}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">+</span>\
              f<span style="color:#e6db74">&#34;{&#39;[alpha]&#39;:^10}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>

<span style="color:#66d9ef">for</span> parameter <span style="color:#f92672">in</span> parameters_labels:
    parameter <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;[&#39;</span> <span style="color:#f92672">+</span> parameter <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;]&#39;</span>
    info_string <span style="color:#f92672">+=</span> f<span style="color:#e6db74">&#34;{parameter:^10}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>

info_string <span style="color:#f92672">+=</span> f<span style="color:#e6db74">&#34;{&#39;[obj_val]&#39;:^10}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>

<span style="color:#66d9ef">for</span> ii <span style="color:#f92672">in</span> range(nparams):
    info_string <span style="color:#f92672">+=</span> f<span style="color:#e6db74">&#34;{&#39;[grad &#39; + str(ii) + &#39;]&#39;:^10}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>

info_string <span style="color:#f92672">+=</span> f<span style="color:#e6db74">&#34;{&#39;[update]&#39;:^10}</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span>

fileprint( info_string )

<span style="color:#75715e"># create dummy grad list for forensic printout</span>
dummy_grad <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> ii <span style="color:#f92672">in</span> range(nparams):
    dummy_grad<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#39;-&#39;</span>)

<span style="color:#75715e">#%% ---------------------------------------------------------------70</span>
<span style="color:#75715e"># Objective function optimization</span>
<span style="color:#75715e"># -----------------------------------------------------------------70</span>

<span style="color:#75715e"># read experimental data file</span>
experimental_data <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>loadtxt( experimental_data_file )

<span style="color:#75715e"># create the objective function specifying the material data</span>
objective_function <span style="color:#f92672">=</span> objective_function_creator(
    parameters_labels, 
    FEM_file, 
    experimental_data, 
    material_data, 
    interested_cols_identifiers, 
    outfolder
)

<span style="color:#75715e"># setup control variables for the minimization algo</span>
params <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(initial_guess)
scale_factor <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(scale_factor)
perturbation_matrix <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>diag(perturbation)
update_counter <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
obj_func_val_min <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>inf
objective_function_increase_counter <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
iteration <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>

<span style="color:#75715e"># measure elapsed time for inverse analysis procedure</span>
tic <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()

<span style="color:#75715e"># minimize objective function</span>
<span style="color:#66d9ef">while</span> iteration <span style="color:#f92672">&lt;=</span> max_iterations:
    iteration <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
    
    <span style="color:#66d9ef">if</span> objective_function<span style="color:#f92672">.</span>sims_counter <span style="color:#f92672">&gt;</span> max_sims_counter:
        fileprint(<span style="color:#e6db74">&#34;Max number of allowed simulations reached.&#34;</span>)
        <span style="color:#66d9ef">break</span>
    
    <span style="color:#75715e"># compute objective function</span>
    obj_func_val <span style="color:#f92672">=</span> objective_function<span style="color:#f92672">.</span>evaluate(params)
    
    <span style="color:#75715e"># check if tolerance has been reached</span>
    <span style="color:#66d9ef">if</span> obj_func_val <span style="color:#f92672">&lt;</span> tolerance:
        <span style="color:#75715e"># gradient evaluation is not necessary</span>
        forensic_printout(objective_function<span style="color:#f92672">.</span>sims_counter, alpha, params, obj_func_val, dummy_grad, update_counter)
        fileprint(<span style="color:#e6db74">&#34;Tolerance reached, procedure exited successfully !!!&#34;</span>)
        <span style="color:#66d9ef">break</span> 
    
    <span style="color:#75715e"># check that objective function is not increasing</span>
    <span style="color:#66d9ef">if</span> obj_func_val <span style="color:#f92672">&gt;=</span> obj_func_val_min:
        objective_function_increase_counter <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">if</span> objective_function_increase_counter <span style="color:#f92672">&gt;</span> max_objective_function_increase_counter:
            fileprint(f<span style="color:#e6db74">&#34;Objective function has increased {objective_function_increase_counter} times, exiting inverse analysis procedure.&#34;</span>)
            <span style="color:#66d9ef">break</span>    

    <span style="color:#75715e"># update historic value of objective function</span>
    obj_func_val_min <span style="color:#f92672">=</span> min(obj_func_val, obj_func_val_min)
    
    <span style="color:#75715e"># start gradient computation by initializing empty gradient list</span>
    gradient <span style="color:#f92672">=</span> []
    
    <span style="color:#66d9ef">for</span> ii <span style="color:#f92672">in</span> range(nparams):
        
        <span style="color:#75715e"># compute perturbed params using perturbation</span>
        <span style="color:#75715e"># perturbed_params = params + perturbation_matrix[:,ii]</span>
        perturbed_params <span style="color:#f92672">=</span> update_params(params, perturbation_matrix[:,ii], limits)
   
        <span style="color:#75715e"># compute objective function value at perturbed parameters</span>
        perturbed_params_obj_func_val <span style="color:#f92672">=</span> objective_function<span style="color:#f92672">.</span>evaluate(perturbed_params)
        
        <span style="color:#75715e"># printout for forensic at each objective function evaluation</span>
        forensic_printout(objective_function<span style="color:#f92672">.</span>sims_counter, alpha, perturbed_params, perturbed_params_obj_func_val, dummy_grad, <span style="color:#e6db74">&#39;-&#39;</span>)
        
        <span style="color:#75715e"># update the gradient list</span>
        gradient<span style="color:#f92672">.</span>append( ( perturbed_params_obj_func_val <span style="color:#f92672">-</span> obj_func_val )<span style="color:#f92672">/</span>perturbation[ii] )
    
    <span style="color:#75715e"># store gradient information in a numpy array</span>
    gradient <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>multiply( scale_factor, np<span style="color:#f92672">.</span>array(gradient) )
    
    <span style="color:#75715e"># normalize gradient in case it is multi-variables</span>
    <span style="color:#75715e"># if nparams &gt; 1:</span>
        <span style="color:#75715e"># gradient = gradient/np.linalg.norm(gradient)</span>
    
    <span style="color:#75715e"># printout for forensic after the gradient calculation</span>
    forensic_printout(objective_function<span style="color:#f92672">.</span>sims_counter, alpha, params, obj_func_val, gradient, update_counter)
        
    <span style="color:#75715e"># update the counter after the gradient calculation</span>
    update_counter <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
    
    <span style="color:#75715e"># update alpha if necessary</span>
    <span style="color:#66d9ef">if</span> explore_alpha_variation_flag:
        exploration <span style="color:#f92672">=</span> {}
        exploration[<span style="color:#e6db74">&#34;sims_counter&#34;</span>] <span style="color:#f92672">=</span> []
        exploration[<span style="color:#e6db74">&#34;alpha&#34;</span>] <span style="color:#f92672">=</span> []
        exploration[<span style="color:#e6db74">&#34;params&#34;</span>] <span style="color:#f92672">=</span> []
        exploration[<span style="color:#e6db74">&#34;obj_func_val&#34;</span>] <span style="color:#f92672">=</span> []
        exploration[<span style="color:#e6db74">&#34;update&#34;</span>] <span style="color:#f92672">=</span> []
        <span style="color:#66d9ef">for</span> factor <span style="color:#f92672">in</span> exploration_factors_list:
            alpha <span style="color:#f92672">=</span> factor<span style="color:#f92672">*</span>alpha
            <span style="color:#75715e"># exploration_params = params - alpha*gradient</span>
            exploration_params <span style="color:#f92672">=</span> update_params(params, <span style="color:#f92672">-</span>alpha<span style="color:#f92672">*</span>gradient, limits)
            exploration_obj_func_val <span style="color:#f92672">=</span> objective_function<span style="color:#f92672">.</span>evaluate(exploration_params)
            
            <span style="color:#75715e"># save data for identification and forensic</span>
            exploration[<span style="color:#e6db74">&#34;sims_counter&#34;</span>]<span style="color:#f92672">.</span>append(objective_function<span style="color:#f92672">.</span>sims_counter)
            exploration[<span style="color:#e6db74">&#34;alpha&#34;</span>]<span style="color:#f92672">.</span>append(alpha)
            exploration[<span style="color:#e6db74">&#34;params&#34;</span>]<span style="color:#f92672">.</span>append(exploration_params)
            exploration[<span style="color:#e6db74">&#34;obj_func_val&#34;</span>]<span style="color:#f92672">.</span>append(exploration_obj_func_val)
            exploration[<span style="color:#e6db74">&#34;update&#34;</span>]<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#39;-&#39;</span>)
    
        <span style="color:#75715e"># identify which alpha values corresponds to the min objective function</span>
        min_index <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>argmin(exploration[<span style="color:#e6db74">&#34;obj_func_val&#34;</span>])
        
        <span style="color:#75715e"># update alpha with value corresponding to min objective function </span>
        alpha <span style="color:#f92672">=</span> exploration[<span style="color:#e6db74">&#34;alpha&#34;</span>][min_index]
        
        <span style="color:#75715e"># flag the chosen alpha</span>
        exploration[<span style="color:#e6db74">&#34;update&#34;</span>][min_index] <span style="color:#f92672">=</span> update_counter
        
        <span style="color:#66d9ef">for</span> ii <span style="color:#f92672">in</span> range(len(exploration_factors_list)):
            <span style="color:#75715e"># printout for forensic at each objective function evaluation</span>
            forensic_printout(
                exploration[<span style="color:#e6db74">&#34;sims_counter&#34;</span>][ii],
                exploration[<span style="color:#e6db74">&#34;alpha&#34;</span>][ii],
                exploration[<span style="color:#e6db74">&#34;params&#34;</span>][ii],
                exploration[<span style="color:#e6db74">&#34;obj_func_val&#34;</span>][ii],
                dummy_grad,
                exploration[<span style="color:#e6db74">&#34;update&#34;</span>][ii]
            )
    
    <span style="color:#75715e"># update parameters with the steepest descent algo</span>
    <span style="color:#75715e"># params += -alpha*gradient</span>
    params <span style="color:#f92672">=</span> update_params(params, <span style="color:#f92672">-</span>alpha<span style="color:#f92672">*</span>gradient, limits)

<span style="color:#66d9ef">if</span> iteration <span style="color:#f92672">==</span> max_iterations:
    fileprint(f<span style="color:#e6db74">&#34;Max iterations reached&#34;</span>)

fileprint(f<span style="color:#e6db74">&#34;Elapsed CPU time: {int((time.time() - tic)/60):5d} [min]&#34;</span>)
</code></pre></div>
      </article>
    </section>

    

    

    
  </div>
</div>


            <footer class="ui basic center aligned segment" style="background-color: transparent;">
              
              <p>© 2021 - 2024 MechEngrLorenzoFiore</p>
              

              <p>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> with theme <a href="https://github.com/g1eny0ung/hugo-theme-dream" target="_blank">Dream</a>.</p>

              
            </footer>
          </div>
        </section>
        <section class="back">
          <div class="dream-max-width">
            <header class="ui basic very padded segment dream-header">
  
  <div class="ui small circular image">
    <img src="/img/avatar_2.jpg" alt="avatar" />
  </div>
  

  <div class="content">
    <h1 class="ui medium header">Lorenzo Fiore&#39;s blog<div class="sub header">Leave the world a better place than you find it</div>
    </h1>

    <article class="ui horizontal list">
      
      <a class="item" href="/posts">
        <i class="archive icon" title="Archives"></i>
      </a>
      
      <a class="item" href="/categories">
        <i class="th list icon" title="All Categories"></i>
      </a>
      <a class="item" href="/tags">
        <i class="tags icon" title="All Tags"></i>
      </a>
    </article>

    
    
    
    
    
      
    
      
    
      
    
      
    
    

    

    
    
    
          <div class="dream-tags">
          
          
          
            <a class="ui label" href="/tags/3d-modelling/" title="3D modelling">
              3D modelling
            </a>
          
          
          
            <a class="ui label" href="/tags/automation/" title="Automation">
              Automation
            </a>
          
          
          
            <a class="ui label" href="/tags/computational/" title="Computational">
              Computational
            </a>
          
          
          
            <a class="ui label" href="/tags/fem/" title="FEM">
              FEM
            </a>
          
          </div>
    

    
  </div>
</header>


<div class="ui relaxed grid dream-grid dream-back">
  
  
  
  <div class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
    <article class="ui segment markdown-body">
      <div class="ui medium header">Once a Scout, always a Scout!</div>
      <p>I&rsquo;m a proud member of the World Wide Scout Movement.</p>
<blockquote>
<p>Try and leave this world a little better than you found it,
and when your turn comes to die,
you can die happy in feeling that at any rate,
you have not wasted your time but have done your best.</p>
</blockquote>
<blockquote>
<p>Robert Baden-Powell, fouder of the Scout Movement</p>
</blockquote>
    </article>
  </div>
  
  <div class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
    <article class="ui segment markdown-body">
      <div class="ui medium header">About me</div>
      <p>If you came up here you want to know a little bit more about myself.
That&rsquo;s awesome!</p>
<p>I&rsquo;m a Mechanical Engineer, a curious person and a maker!
I don&rsquo;t waste any time trying to learn everything I can about the
topic I love the most, be it mechanical design, programming,
old school hand abilities, music, languages, you name it!</p>
<p>This websites purpose is to share my knowledge and experience hoping
this would be of any help for anyone facing the challenges I face.
Enjoy and let&rsquo;s stay in contact!</p>
    </article>
  </div>
  

  <div class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
    <article class="ui segment">
      <div class="ui medium header">Social Links</div>
      <nav class="ui secondary menu dream-menu dream-socials">
  

  

  

  

  

  

  
  <div class="item">
    <a href="https://www.linkedin.com/in/lorenzo-fiore-372b83194" target="_blank">
      <i class="large linkedin icon" title="Linkedin"></i>
    </a>
  </div>
  

  
  <div class="item">
    <a href="https://github.com/MechEngrLorenzoFiore" target="_blank">
      <i class="large github icon" title="GitHub"></i>
    </a>
  </div>
  

  

  
</nav>

    </article>
  </div>

  <div class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
    
  </div>

  
  
</div>

          </div>
        </section>
      </div>
    </div>

    <script>
  window.defaultDark =  null 
  window.backgroundDark =  null 
  window.backgroundImageDark =  null 
  window.darkNav =  null 
  window.hasTwitterEmbed =  null 
  window.maxTags =  null 

  if (window.hasTwitterEmbed) {
    
    window.twttr = (function (d, s, id) {
      var js,
        fjs = d.getElementsByTagName(s)[0],
        t = window.twttr || {}
      if (d.getElementById(id)) return t
      js = d.createElement(s)
      js.id = id
      js.src = 'https://platform.twitter.com/widgets.js'
      fjs.parentNode.insertBefore(js, fjs)

      t._e = []
      t.ready = function (f) {
        t._e.push(f)
      }

      return t
    })(document, 'script', 'twitter-wjs')
  }
</script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/overlayscrollbars@1.13.1/js/jquery.overlayScrollbars.min.js"></script>
<script src="/js/header.js"></script>
<script src="/js/main.js"></script>
<script src="/js/theme.js"></script>

    





<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.0.0-rc.1/dist/html2canvas.min.js"></script>
<script src="/js/post.js" defer></script>


    
    <div class="ui inverted segment" id="dream-search">
  <div class="ui search">
    <div class="ui transparent input">
      <input class="prompt" type="text" placeholder="Search" />
    </div>
    <div class="results"></div>
  </div>
</div>
<script>
  $(document).ready(function () {
    $.getJSON('https:\/\/MechEngrLorenzoFiore.github.io\//index.json', function (data) {
      $('.ui.search').search({
        source: data,
        searchFields: ['title'],
        showNoResults: true,
      })
    })
  })
</script>
<script src="/js/search.js"></script>

    

    

    
  </body>
</html>
